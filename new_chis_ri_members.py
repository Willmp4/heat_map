import pandas as pd
import numpy as np
import plotly.express as px
import xlrd
import openpyxl
book = openpyxl.load_workbook('.data/chis_riv.xlsx')
sheet = book.get_sheet_by_name('Sheet1')
data = [int(sheet.cell(row=r, column=c).value) for c in range(1, sheet.max_column+1) for r in range(1, sheet.max_row+1)]
keys = [i for i in range(len(data))]

count =dict(zip(keys, data))



p=pd.DataFrame({'latitude': {0: 51.54069, 1: 51.22739, 2: 51.58185, 3: 51.57348, 4: 51.5648, 5: 51.74179, 6: 51.42921, 7: 51.41231, 8: 51.53167, 9: 51.62083, 10: 51.52384, 11: 51.54094, 12: 51.5238, 13: 51.53618, 14: 52.78713, 15: 50.76915, 16: 52.11628, 17: 51.49001, 18: 51.46667, 19: 51.44731, 20: 51.45962, 21: 51.47625, 22: 51.48592, 23: 51.48814, 24: 51.48947, 25: 51.46645, 26: 51.48295, 27: 51.47199, 28: 51.47182, 29: 51.47073, 30: 51.4701, 31: 51.46949, 32: 51.47222, 33: 51.46919, 34: 51.46875, 35: 51.46995, 36: 51.4696, 37: 51.47169, 38: 51.47405, 39: 51.47279, 40: 51.4743, 41: 51.4746, 42: 51.4748, 43: 51.47355, 44: 51.47276, 45: 51.47246, 46: 51.47299, 47: 51.47219, 48: 51.47235, 49: 51.47221, 50: 51.4654, 51: 51.46702, 52: 51.46667, 53: 51.46749, 54: 51.46605, 55: 51.47064, 56: 51.46984, 57: 51.47254, 58: 51.46971, 59: 51.46869, 60: 51.4699, 61: 51.46664, 62: 51.46762, 63: 51.4734, 64: 51.47269, 65: 51.47134, 66: 51.4716, 67: 51.47097, 68: 51.471, 69: 51.4707, 70: 51.47029, 71: 51.47023, 72: 51.47078, 73: 51.46934, 74: 51.46851, 75: 51.46952, 76: 51.4697, 77: 51.46987, 78: 51.47052, 79: 51.46969, 80: 51.48313, 81: 51.48575, 82: 51.48602, 83: 51.48229, 84: 51.4827, 85: 51.48435, 86: 51.48678, 87: 51.48608, 88: 51.4842, 89: 51.47406, 90: 51.48262, 91: 51.48485, 92: 51.48498, 93: 51.48535, 94: 51.48626, 95: 51.482, 96: 51.48522, 97: 51.48357, 98: 51.48177, 99: 51.47976, 100: 51.47536, 101: 51.4744, 102: 51.47594, 103: 51.47393, 104: 51.48721, 105: 51.48699, 106: 51.48667, 107: 51.4733, 108: 51.47373, 109: 51.47438, 110: 51.47449, 111: 51.4736, 112: 51.47883, 113: 51.48029, 114: 51.47859, 115: 51.47971, 116: 51.47894, 117: 51.48078, 118: 51.48008, 119: 51.47872, 120: 51.47467, 121: 51.47511, 122: 51.47476, 123: 51.4757, 124: 51.48626, 125: 51.47496, 126: 51.47559, 127: 51.47583, 128: 51.47592, 129: 51.47687, 130: 51.47622, 131: 51.47659, 132: 51.46008, 133: 51.46008, 134: 51.46373, 135: 51.47098, 136: 51.46297, 137: 51.46503, 138: 51.46827, 139: 51.46538, 140: 51.45944, 141: 51.46671, 142: 51.46727, 143: 51.46657, 144: 51.4672, 145: 51.46245, 146: 51.46598, 147: 51.46223, 148: 51.46204, 149: 51.47132, 150: 51.46534, 151: 51.46299, 152: 51.4651, 153: 51.46596, 154: 51.46647, 155: 51.46571, 156: 51.46859, 157: 51.46876, 158: 51.47006, 159: 51.46354, 160: 51.46339, 161: 51.46579, 162: 51.46704, 163: 51.46919, 164: 51.46877, 165: 51.46893, 166: 51.46889, 167: 51.469, 168: 51.46174, 169: 51.45875, 170: 51.47004, 171: 51.46728, 172: 51.46637, 173: 51.46637, 174: 51.46803, 175: 51.46878, 176: 51.46267, 177: 51.46241, 178: 51.46293, 179: 51.46386, 180: 51.44865, 181: 51.45849, 182: 51.46357, 183: 51.4526, 184: 51.45287, 185: 51.45364, 186: 51.454, 187: 51.45961, 188: 51.46424, 189: 51.46394, 190: 51.46443, 191: 51.46504, 192: 51.45965, 193: 51.45588, 194: 51.46422, 195: 51.44908, 196: 51.44109, 197: 51.41642, 198: 51.42785, 199: 51.49788, 200: 51.48638, 201: 51.49534, 202: 51.49347, 203: 51.49787, 204: 51.49682, 205: 51.49234, 206: 51.48685, 207: 51.45736, 208: 51.49109, 209: 51.49185, 210: 51.49138, 211: 51.48979, 212: 51.4917, 213: 51.48255, 214: 51.46745, 215: 51.47151, 216: 51.47056, 217: 51.47287, 218: 51.47571, 219: 51.47498, 220: 51.47764, 221: 51.47892, 222: 51.48032, 223: 51.5004, 224: 51.4947, 225: 51.48969, 226: 51.49655, 227: 51.49839, 228: 51.47622, 229: 51.47546, 230: 51.46367, 231: 51.46396, 232: 51.45094, 233: 51.45175, 234: 51.4464, 235: 51.46114, 236: 51.46204, 237: 51.46221, 238: 51.46147, 239: 51.46253, 240: 51.46507, 241: 51.46479, 242: 51.46519, 243: 51.45781, 244: 51.46053, 245: 51.45882, 246: 51.4586, 247: 51.45887, 248: 51.46013, 249: 51.45642, 250: 51.46094, 251: 51.45983, 252: 51.45748, 253: 51.45657, 254: 51.43901, 255: 51.3902, 256: 51.3902, 257: 51.44453, 258: 51.4547, 259: 51.47052, 260: 51.46289, 261: 51.46109, 262: 51.45804, 263: 51.48715, 264: 51.48778, 265: 51.48947, 266: 51.48849, 267: 51.49047, 268: 51.49084, 269: 51.48831, 270: 51.48289, 271: 51.49096, 272: 51.49362, 273: 51.46037, 274: 51.45937, 275: 51.46152, 276: 51.46344, 277: 51.46451, 278: 51.47209, 279: 51.46818, 280: 51.47065, 281: 51.46847, 282: 51.46748, 283: 51.46613, 284: 51.46716, 285: 51.48545, 286: 51.48247, 287: 51.48234, 288: 51.48394, 289: 51.47962, 290: 51.48041, 291: 51.4747, 292: 51.47413, 293: 51.47744, 294: 51.47731, 295: 51.47876, 296: 51.48105, 297: 51.48007, 298: 51.47929, 299: 51.4821, 300: 51.47974, 301: 51.48013, 302: 51.46907, 303: 51.47269, 304: 51.47058, 305: 51.47157, 306: 51.46781, 307: 51.53523, 308: 51.53075, 309: 51.52061, 310: 51.50664, 311: 51.50801, 312: 51.5094, 313: 51.50385, 314: 51.50026, 315: 51.51486, 316: 51.52366, 317: 51.4999, 318: 51.4987, 319: 51.49846, 320: 51.49813, 321: 51.49558, 322: 51.4963, 323: 51.49329, 324: 51.49547, 325: 51.50107, 326: 51.50044, 327: 51.50014, 328: 51.49843, 329: 51.49648, 330: 51.49555, 331: 51.48995, 332: 51.48906, 333: 51.48617, 334: 51.5167, 335: 51.51378, 336: 51.51363, 337: 51.51262, 338: 51.51495, 339: 51.52349, 340: 51.51184, 341: 51.50122, 342: 51.50203, 343: 51.50702, 344: 51.51179, 345: 51.50372, 346: 51.49899, 347: 51.5021, 348: 51.50167, 349: 51.50175, 350: 51.49969, 351: 51.49719, 352: 51.49878, 353: 51.49663, 354: 51.49677, 355: 51.49364, 356: 51.49355, 357: 51.49326, 358: 51.49849, 359: 51.49072, 360: 51.48805, 361: 51.49151, 362: 51.49103, 363: 51.48937, 364: 51.48962, 365: 51.49265, 366: 51.49185, 367: 51.49111, 368: 51.48454, 369: 51.48491, 370: 51.48652, 371: 51.48938, 372: 51.48788, 373: 51.48636, 374: 51.48614, 375: 51.48347, 376: 51.48156, 377: 51.47839, 378: 51.47714, 379: 51.47547, 380: 51.48056, 381: 51.48269, 382: 51.48361, 383: 51.49059, 384: 51.48216, 385: 51.48943, 386: 51.48838, 387: 51.48875, 388: 51.48665, 389: 51.48711, 390: 51.4868, 391: 51.48644, 392: 51.48062, 393: 51.486, 394: 51.48666, 395: 51.48295, 396: 51.48185, 397: 51.48486, 398: 51.48616, 399: 51.48532, 400: 51.48467, 401: 51.4879, 402: 51.48628, 403: 51.48715, 404: 51.4862, 405: 51.48772, 406: 51.48526, 407: 51.48546, 408: 51.48233, 409: 51.48295, 410: 51.48272, 411: 51.48065, 412: 51.47988, 413: 51.47832, 414: 51.48037, 415: 51.49074, 416: 51.49108, 417: 51.491, 418: 51.48903, 419: 51.4911, 420: 51.4894, 421: 51.49098, 422: 51.48839, 423: 51.48879, 424: 51.48876, 425: 51.50107, 426: 51.49502, 427: 51.49843, 428: 51.49948, 429: 51.49845, 430: 51.49865, 431: 51.499, 432: 51.49276, 433: 51.49466, 434: 51.53129, 435: 51.51847, 436: 51.51806, 437: 51.51746, 438: 51.49655, 439: 51.4948, 440: 51.50341, 441: 51.4958, 442: 51.50628, 443: 51.49582, 444: 51.49368, 445: 51.49831, 446: 51.49432, 447: 51.49463, 448: 51.49519, 449: 51.49567, 450: 51.4953, 451: 51.49279, 452: 51.48875, 453: 51.4898, 454: 51.48981, 455: 51.50401, 456: 51.50313, 457: 51.50447, 458: 51.50561, 459: 51.4992, 460: 51.49787, 461: 51.49747, 462: 51.49681, 463: 51.65216},
 'longitude':{0: 0.05325, 1: -0.7628, 2: -0.33211, 3: -0.42055, 4: -0.40276, 5: -0.85749, 6: -0.3109, 7: -0.28894, 8: -0.09562, 9: -0.18665, 10: -0.16138, 11: -0.14879, 12: -0.25357, 13: -0.27815, 14: -0.15112, 15: -0.87929, 16: -4.04968, 17: -0.12253, 18: -0.01743, 19: -0.07299, 20: 0.06096, 21: -0.18116, 22: -0.18504, 23: -0.18701, 24: -0.18687, 25: -0.18194, 26: -0.14807, 27: -0.25112, 28: -0.2516, 29: -0.25007, 30: -0.2516, 31: -0.25214, 32: -0.25236, 33: -0.25326, 34: -0.25288, 35: -0.25131, 36: -0.25131, 37: -0.24115, 38: -0.23948, 39: -0.23866, 40: -0.23882, 41: -0.24034, 42: -0.24066, 43: -0.24092, 44: -0.23989, 45: -0.24011, 46: -0.24273, 47: -0.24167, 48: -0.24955, 49: -0.24996, 50: -0.24158, 51: -0.23321, 52: -0.25144, 53: -0.25198, 54: -0.25009, 55: -0.24688, 56: -0.24781, 57: -0.24747, 58: -0.24632, 59: -0.24639, 60: -0.24446, 61: -0.2482, 62: -0.24854, 63: -0.24467, 64: -0.25218, 65: -0.25457, 66: -0.25345, 67: -0.2535, 68: -0.25196, 69: -0.25287, 70: -0.25401, 71: -0.25224, 72: -0.24846, 73: -0.24977, 74: -0.2523, 75: -0.24944, 76: -0.25354, 77: -0.25373, 78: -0.25528, 79: -0.25538, 80: -0.22804, 81: -0.23082, 82: -0.23059, 83: -0.22991, 84: -0.23114, 85: -0.22884, 86: -0.23048, 87: -0.23021, 88: -0.22937, 89: -0.24859, 90: -0.23766, 91: -0.2373, 92: -0.24271, 93: -0.23314, 94: -0.23414, 95: -0.23687, 96: -0.23384, 97: -0.23478, 98: -0.23603, 99: -0.23694, 100: -0.2433, 101: -0.24223, 102: -0.24092, 103: -0.24112, 104: -0.23645, 105: -0.23656, 106: -0.23633, 107: -0.24817, 108: -0.24852, 109: -0.24962, 110: -0.24996, 111: -0.24948, 112: -0.24256, 113: -0.24595, 114: -0.24528, 115: -0.2389, 116: -0.24063, 117: -0.24057, 118: -0.23927, 119: -0.2411, 120: -0.24877, 121: -0.24774, 122: -0.24643, 123: -0.24826, 124: -0.23215, 125: -0.24414, 126: -0.24558, 127: -0.24242, 128: -0.24525, 129: -0.2382, 130: -0.24003, 131: -0.24317, 132: -0.2779, 133: -0.2779, 134: -0.26982, 135: -0.27156, 136: -0.27755, 137: -0.27563, 138: -0.26975, 139: -0.27112, 140: -0.27027, 141: -0.27041, 142: -0.27023, 143: -0.27184, 144: -0.27208, 145: -0.26929, 146: -0.26845, 147: -0.27062, 148: -0.27312, 149: -0.27162, 150: -0.27261, 151: -0.27337, 152: -0.26483, 153: -0.25879, 154: -0.25647, 155: -0.25322, 156: -0.26123, 157: -0.26047, 158: -0.26252, 159: -0.26498, 160: -0.26632, 161: -0.26343, 162: -0.26337, 163: -0.25998, 164: -0.25941, 165: -0.25769, 166: -0.25678, 167: -0.25639, 168: -0.26028, 169: -0.26757, 170: -0.25734, 171: -0.25441, 172: -0.22203, 173: -0.22203, 174: -0.21949, 175: -0.22008, 176: -0.21754, 177: -0.21802, 178: -0.21575, 179: -0.20846, 180: -0.23812, 181: -0.23707, 182: -0.2387, 183: -0.23807, 184: -0.24327, 185: -0.2401, 186: -0.24258, 187: -0.23702, 188: -0.24289, 189: -0.22972, 190: -0.23436, 191: -0.23548, 192: -0.23204, 193: -0.22201, 194: -0.18544, 195: -0.17339, 196: -0.20464, 197: -0.19971, 198: -0.18919, 199: -0.13335, 200: -0.1336, 201: -0.15079, 202: -0.15835, 203: -0.16456, 204: -0.16819, 205: -0.16493, 206: -0.16099, 207: -0.13333, 208: -0.18505, 209: -0.1903, 210: -0.19094, 211: -0.191, 212: -0.19822, 213: -0.199, 214: -0.18741, 215: -0.20377, 216: -0.20281, 217: -0.19529, 218: -0.1959, 219: -0.20492, 220: -0.20481, 221: -0.21532, 222: -0.20715, 223: -0.16521, 224: -0.17066, 225: -0.17841, 226: -0.18875, 227: -0.18156, 228: -0.14538, 229: -0.11757, 230: -0.32362, 231: -0.32218, 232: -0.30915, 233: -0.3177, 234: -0.33574, 235: -0.28169, 236: -0.27937, 237: -0.27869, 238: -0.28129, 239: -0.28049, 240: -0.28352, 241: -0.28153, 242: -0.27892, 243: -0.30242, 244: -0.29364, 245: -0.29302, 246: -0.29551, 247: -0.28985, 248: -0.29005, 249: -0.29208, 250: -0.28989, 251: -0.29831, 252: -0.29772, 253: -0.2985, 254: -0.30481, 255: -0.43335, 256: -0.43335, 257: -0.35632, 258: -0.35365, 259: -0.32874, 260: -0.33325, 261: -0.32913, 262: -0.34543, 263: -0.2954, 264: -0.29583, 265: -0.30444, 266: -0.28804, 267: -0.30517, 268: -0.30293, 269: -0.28901, 270: -0.30995, 271: -0.31498, 272: -0.29676, 273: -0.30809, 274: -0.30933, 275: -0.28921, 276: -0.2886, 277: -0.29475, 278: -0.2907, 279: -0.28959, 280: -0.2896, 281: -0.2915, 282: -0.29317, 283: -0.29976, 284: -0.29876, 285: -0.28895, 286: -0.28173, 287: -0.2836, 288: -0.28396, 289: -0.28486, 290: -0.28504, 291: -0.29151, 292: -0.28809, 293: -0.28624, 294: -0.27646, 295: -0.28309, 296: -0.2778, 297: -0.2812, 298: -0.28092, 299: -0.2789, 300: -0.27919, 301: -0.2788, 302: -0.28692, 303: -0.28432, 304: -0.28341, 305: -0.28035, 306: -0.27901, 307: -0.44737, 308: -0.37603, 309: -0.22167, 310: -0.2091, 311: -0.21457, 312: -0.24461, 313: -0.24398, 314: -0.25084, 315: -0.32201, 316: -0.32045, 317: -0.21843, 318: -0.21563, 319: -0.22002, 320: -0.21811, 321: -0.21269, 322: -0.21586, 323: -0.21282, 324: -0.21493, 325: -0.20724, 326: -0.2076, 327: -0.20636, 328: -0.20356, 329: -0.20333, 330: -0.20906, 331: -0.20862, 332: -0.21282, 333: -0.20452, 334: -0.15468, 335: -0.15301, 336: -0.17401, 337: -0.17433, 338: -0.19162, 339: -0.26117, 340: -0.24684, 341: -0.27226, 342: -0.27669, 343: -0.28273, 344: -0.28151, 345: -0.25833, 346: -0.26132, 347: -0.25871, 348: -0.25997, 349: -0.25825, 350: -0.25261, 351: -0.25139, 352: -0.25872, 353: -0.25968, 354: -0.25294, 355: -0.25512, 356: -0.25679, 357: -0.25723, 358: -0.25484, 359: -0.26005, 360: -0.25938, 361: -0.2594, 362: -0.25831, 363: -0.25686, 364: -0.25596, 365: -0.25339, 366: -0.2584, 367: -0.25186, 368: -0.25132, 369: -0.25042, 370: -0.25067, 371: -0.24456, 372: -0.24724, 373: -0.25212, 374: -0.25617, 375: -0.25458, 376: -0.25173, 377: -0.26081, 378: -0.2606, 379: -0.25634, 380: -0.25345, 381: -0.253, 382: -0.25194, 383: -0.28252, 384: -0.27017, 385: -0.28242, 386: -0.27985, 387: -0.27921, 388: -0.26493, 389: -0.26978, 390: -0.26637, 391: -0.26233, 392: -0.26529, 393: -0.26542, 394: -0.26284, 395: -0.26795, 396: -0.26648, 397: -0.2669, 398: -0.26981, 399: -0.2724, 400: -0.27333, 401: -0.27118, 402: -0.27224, 403: -0.27456, 404: -0.27459, 405: -0.2748, 406: -0.27366, 407: -0.2761, 408: -0.2736, 409: -0.27212, 410: -0.27275, 411: -0.26847, 412: -0.26843, 413: -0.2729, 414: -0.27388, 415: -0.27313, 416: -0.26959, 417: -0.26728, 418: -0.27015, 419: -0.26419, 420: -0.26741, 421: -0.26229, 422: -0.26173, 423: -0.26243, 424: -0.26495, 425: -0.2665, 426: -0.26475, 427: -0.26995, 428: -0.26277, 429: -0.26729, 430: -0.26387, 431: -0.26186, 432: -0.26517, 433: -0.27604, 434: -0.29571, 435: -0.30657, 436: -0.30446, 437: -0.30189, 438: -0.31304, 439: -0.31111, 440: -0.30761, 441: -0.2994, 442: -0.30772, 443: -0.22834, 444: -0.23972, 445: -0.24327, 446: -0.24415, 447: -0.24093, 448: -0.24248, 449: -0.24025, 450: -0.24605, 451: -0.24204, 452: -0.22823, 453: -0.2426, 454: -0.24355, 455: -0.33789, 456: -0.32927, 457: -0.19483, 458: -0.19257, 459: -0.18625, 460: -0.20122, 461: -0.20264, 462: -0.19345, 463: -0.5166} ,
 'count':count})
 
fig = px.density_mapbox(p, lat='latitude', lon='longitude', z='count',
                        mapbox_style="stamen-terrain")
 
fig.show()
results_path = 'results.png'
#print(results_path)
